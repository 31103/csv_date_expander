# アクティブコンテキスト

## 現在の作業内容

- **CSVファイルのドラッグ＆ドロップ機能を追加しました。**
- **ファイル選択/ドロップ時の即時処理を停止し、ボタンクリックで処理を開始するように修正しました。**
- **選択されたファイル名を表示する機能を追加しました。**
- **`README.md` を更新し、上記の変更内容を反映しました。**
- (完了済み) 展開行数上限の挙動変更とデフォルト値変更を実装しました。
- (完了済み) エラー表示のUI詳細化を実装しました。
- (完了済み) CSVエンコーディング自動検出機能（UTF-8/Shift_JIS）を実装しました。
- (完了済み) プロジェクトのリファクタリング作業。
- (完了済み) TypeScriptとDenoの導入とコードのモジュール化。
- (完了済み) CSSのプレーンCSSへの移行とインライン化。
- (完了済み) 単一HTML生成ビルドスクリプト (`build.ts`) の作成。

## 最近の変更

- **`src/main.ts` を変更:**
  - ファイル選択 (`change`) およびファイルドロップ (`drop`) イベントリスナーが
    `processFile` を直接呼び出すのではなく、`updateSelectedFile`
    関数を呼び出すように修正。
  - `updateSelectedFile` 関数を追加し、選択されたファイルを `selectedFile`
    変数に保持し、ファイル名表示を更新するように実装。
  - `handleProcessClick` 関数が `selectedFile`
    変数に保持されたファイルを使用するように変更。
  - `processFile`
    関数を非同期関数として抽出し、ファイル読み込みとCSV処理のコアロジックを内包するようにリファクタリング。
- **`src/domHandler.ts` を変更:**
  - ドラッグ＆ドロップエリア (`#fileDropArea`) の要素参照を追加。
  - ドラッグ中の視覚的フィードバック (`setDropAreaHighlight`) および `dragover`,
    `dragleave`, `drop` イベントリスナーを追加。
  - 選択されたファイル名を表示する要素 (`#selectedFileName`) の参照を追加。
  - ファイル名を表示/クリアする関数 (`showSelectedFileName`,
    `clearSelectedFileName`) を追加。
  - `setupEventListeners`
    関数にファイルドロップ時のコールバック引数を追加し、ドロップされたファイルを渡すように変更。
- **`index.html` を変更:**
  - ファイル入力欄を囲む `div` に `id="fileDropArea"` を追加。
  - ドラッグ＆ドロップを促すテキスト (`.drop-prompt`) を追加。
  - 選択されたファイル名を表示する要素 (`#selectedFileName`) を追加。
- **`src/style.css` を変更:**
  - ドラッグ＆ドロップエリア (`#fileDropArea`, `.dragover`)
    および選択ファイル名表示 (`.selected-file-name`, `.hidden`)
    用のスタイルを追加。
- **`README.md` を更新:**
  - ドラッグ＆ドロップ機能と新しいファイル選択ワークフローに関する説明を追記・修正。
- (以前の変更) `src/main.ts` を変更: 展開行数上限の挙動変更とデフォルト値変更。
- (以前の変更) `README.md` を更新: 展開行数上限に関する説明を修正。
- (以前の変更) `index.html` を変更: 警告詳細表示用のエリアを追加。
- (以前の変更) `src/style.css` を変更: 警告詳細エリアのスタイルを追加。
- (以前の変更) `src/domHandler.ts` を変更:
  警告詳細関連のDOM操作関数を追加・修正。
- (以前の変更) `src/main.ts` を変更: 行ごとの警告詳細収集ロジックを追加。
- (以前の変更) `README.md` を更新: エラー/警告表示に関する説明を修正。
- (以前の変更) `src/main.ts` を変更: CSVエンコーディング自動検出機能を追加。
- (以前の変更) `README.md` を更新: エンコーディング対応に関する説明を修正。
- (以前の変更) プロジェクト構造を `src/` ディレクトリベースに変更。
- (以前の変更) JavaScriptをTypeScriptに移行し、モジュール分割。
- (以前の変更) `src/style.css` を作成し、Tailwind CSSを削除。
- (以前の変更) `index.html` テンプレートを作成。
- (以前の変更) `build.ts` を作成し、単一HTML生成を可能にした。

## 次のステップ

- 現在のタスク（ドラッグ＆ドロップ機能追加と即時処理停止修正）は完了しました。
- 今後の作業は、ユーザーからのフィードバックや新たな要件に基づいて決定されます。
  - 候補: TypeScriptモジュールに対する単体テストの追加 (`deno test`)。
  - より堅牢なCSV解析ライブラリの導入検討。
